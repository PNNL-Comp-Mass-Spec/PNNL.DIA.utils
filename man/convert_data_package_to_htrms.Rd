% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dms_to_htrms.R
\name{convert_data_package_to_htrms}
\alias{convert_data_package_to_htrms}
\title{Convert .raw mass spectrometry files to HTRMS format}
\usage{
convert_data_package_to_htrms(
  data_package_num,
  output_folder,
  converter_path = "C:/Program Files (x86)/Biognosys/HTRMS Converter/HTRMSConverter.exe",
  settings = NULL,
  delay_seconds = 5,
  force_reconvert = FALSE,
  timeout_seconds = 1800
)
}
\arguments{
\item{data_package_num}{(integer) DMS data package ID number}

\item{output_folder}{(character) Local folder where conversion results will be saved}

\item{converter_path}{(character) Full path to HTRMSConverter.exe; default is path on KAIJU}

\item{settings}{(character) Optional path or name of conversion settings schema to use}

\item{delay_seconds}{(integer) Number of seconds to wait between file conversions (default: 5)}

\item{force_reconvert}{(logical) Whether to reconvert files that already exist (default: FALSE)}

\item{timeout_seconds}{(numeric) Maximum time in seconds to wait for a single conversion (default: 1800)}
}
\value{
A list containing:
  \item{raw_results}{A list with detailed results for each file conversion}
  \item{results_df}{A data frame summarizing all conversion results}
  \item{log_file}{Path to the generated log file}
  \item{csv_file}{Path to the saved CSV results file}
  \item{htrms_folder}{Path to the folder containing converted .htrms files}
  \item{elapsed_time}{Total time taken for the conversion process}
}
\description{
Converts .raw files from DMS to .htrms format for use with Biognosys Spectronaut.
  Files are processed sequentially with a delay between conversions for stability.
  Converted files are saved in a dedicated subfolder, and detailed logs and results are generated.
  Files that have already been converted are automatically skipped.
}
\details{
This function automates the process of converting Thermo .raw files stored on DMS to 
the Biognosys HTRMS format for analysis in Spectronaut. It uses the HTRMSConverter
command line tool and processes files sequentially for maximum stability.

The function:
\itemize{
  \item Retrieves file paths from DMS based on the data package number
  \item Creates a dedicated output folder structure
  \item Converts files one by one with a delay between conversions
  \item Verifies that output files exist and have valid content
  \item Logs conversion details including timing and file sizes
  \item Identifies potential outliers in conversion size ratios
  \item Returns detailed results for further analysis
}

Converted .htrms files are saved in a 'htrms' subfolder under the specified output folder.
Log files and CSV reports are saved in the main output folder with date-based filenames.
}
\examples{
\dontrun{
# Path to the HTRMSConverter.exe
# This is the local path on KAIJU
converter_path <- "C:/Program Files (x86)/Biognosys/HTRMS Converter/HTRMSConverter.exe"

# Convert a data package
results <- convert_data_package_to_htrms(
   data_package_num = 6447, 
   output_folder = "E:/Data/Converted_Files",
   converter_path = converter_path,
   delay_seconds = 5
)
}

}
